# –§–∏–∫—Å: –û—à–∏–±–∫–∞ "JSON —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω" –ø—Ä–∏ –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥–µ –ø–æ—Å–ª–µ 3-4 —Ç–∞–π—Ç–ª–æ–≤

## –î–∞—Ç–∞
2025-10-07

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –º–∞—Å—Å–æ–≤–æ–º –∏–º–ø–æ—Ä—Ç–µ –º–∞–Ω–≥ (—Ü–µ–ª–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–∞–ª–æ–≥–∞) –ø–æ—Å–ª–µ 3-4 —É—Å–ø–µ—à–Ω—ã—Ö —Ç–∞–π—Ç–ª–æ–≤ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –æ—à–∏–±–∫–∏:
- **"JSON —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"** (`manga-info` endpoint –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404)
- –¢–∞–π—Ç–ª—ã —Å–∫–∏–ø–∞—é—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π
- –ê–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è

## –ü—Ä–∏—á–∏–Ω–∞

### 1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ `getMangaInfo()`

**–§–∞–π–ª:** `MelonIntegrationService.java`

**–ö–æ–¥ –î–û:**
```java
public Map<String, Object> getMangaInfo(String filename) {
    String url = melonServiceUrl + "/manga-info/" + filename;
    ResponseEntity<Map> response = restTemplate.getForEntity(url, Map.class);
    return response.getBody();
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–∏ –º–∞—Å—Å–æ–≤–æ–º –ø–∞—Ä—Å–∏–Ω–≥–µ MelonService –º–æ–∂–µ—Ç –Ω–µ —É—Å–ø–µ–≤–∞—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å JSON —Ñ–∞–π–ª—ã
- `restTemplate.getForEntity()` –ø–∞–¥–∞–µ—Ç —Å **HttpClientErrorException.NotFound** (404)
- **–í—Å—è –∑–∞–¥–∞—á–∞ –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥–∞ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è** –∏–∑-–∑–∞ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ `getTaskStatus()`

**–§–∞–π–ª:** `MelonIntegrationService.java`

**–ö–æ–¥ –î–û:**
```java
public Map<String, Object> getTaskStatus(String taskId) {
    String url = melonServiceUrl + "/status/" + taskId;
    ResponseEntity<Map> response = restTemplate.getForEntity(url, Map.class);
    return response.getBody();
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ó–∞–¥–∞—á–∏ –º–æ–≥—É—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å—á–µ–∑–∞—Ç—å –∏–∑ MelonService
- `restTemplate.getForEntity()` –ø–∞–¥–∞–µ—Ç —Å 404
- –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª `waitForTaskCompletion()` –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É

## –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ retry –ª–æ–≥–∏–∫–∞ –≤ `getMangaInfo()`

**–ö–æ–¥ –ü–û–°–õ–ï:**
```java
public Map<String, Object> getMangaInfo(String filename) {
    String url = melonServiceUrl + "/manga-info/" + filename;
    
    int maxRetries = 5;
    int retryDelayMs = 3000; // 3 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
    
    for (int attempt = 1; attempt <= maxRetries; attempt++) {
        try {
            logger.info("–ü–æ–ª—É—á–µ–Ω–∏–µ manga-info –¥–ª—è '{}' (–ø–æ–ø—ã—Ç–∫–∞ {}/{})", filename, attempt, maxRetries);
            ResponseEntity<Map> response = restTemplate.getForEntity(url, Map.class);
            Map<String, Object> body = response.getBody();
            
            if (body != null) {
                logger.info("–£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω manga-info –¥–ª—è '{}'", filename);
                return body;
            } else {
                logger.warn("–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ manga-info –¥–ª—è '{}', –ø–æ–ø—ã—Ç–∫–∞ {}/{}", 
                    filename, attempt, maxRetries);
            }
            
        } catch (org.springframework.web.client.HttpClientErrorException.NotFound e) {
            logger.warn("JSON —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è '{}' (–ø–æ–ø—ã—Ç–∫–∞ {}/{}): {}. " +
                "–í–æ–∑–º–æ–∂–Ω–æ, MelonService –µ—â–µ –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ {}ms...",
                filename, attempt, maxRetries, e.getMessage(), retryDelayMs);
                
        } catch (Exception e) {
            logger.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è manga-info –¥–ª—è '{}' (–ø–æ–ø—ã—Ç–∫–∞ {}/{}): {}", 
                filename, attempt, maxRetries, e.getMessage());
        }
        
        // –ï—Å–ª–∏ –Ω–µ –ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ - –∂–¥–µ–º –ø–µ—Ä–µ–¥ retry
        if (attempt < maxRetries) {
            try {
                Thread.sleep(retryDelayMs);
            } catch (InterruptedException ie) {
                Thread.currentThread().interrupt();
                logger.error("–ü—Ä–µ—Ä–≤–∞–Ω–æ –æ–∂–∏–¥–∞–Ω–∏–µ retry –¥–ª—è '{}'", filename);
                break;
            }
        }
    }
    
    // –ï—Å–ª–∏ –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    logger.error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å manga-info –¥–ª—è '{}' –ø–æ—Å–ª–µ {} –ø–æ–ø—ã—Ç–æ–∫", filename, maxRetries);
    return Map.of(
        "error", "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å manga-info –ø–æ—Å–ª–µ " + maxRetries + " –ø–æ–ø—ã—Ç–æ–∫",
        "filename", filename
    );
}
```

**–£–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ **5 –ø–æ–ø—ã—Ç–æ–∫** —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 3 —Å–µ–∫—É–Ω–¥—ã
- ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ **404 –æ—à–∏–±–æ–∫**
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–∏
- ‚úÖ **Graceful degradation** - –≤–æ–∑–≤—Ä–∞—Ç Map —Å –æ—à–∏–±–∫–æ–π –≤–º–µ—Å—Ç–æ exception

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ `getTaskStatus()`

**–ö–æ–¥ –ü–û–°–õ–ï:**
```java
public Map<String, Object> getTaskStatus(String taskId) {
    String url = melonServiceUrl + "/status/" + taskId;
    
    try {
        ResponseEntity<Map> response = restTemplate.getForEntity(url, Map.class);
        Map<String, Object> body = response.getBody();
        
        if (body != null) {
            return body;
        } else {
            logger.warn("–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏: {}", taskId);
            return Map.of(
                "status", "unknown",
                "message", "–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –æ—Ç MelonService"
            );
        }
        
    } catch (org.springframework.web.client.HttpClientErrorException.NotFound e) {
        logger.warn("–ó–∞–¥–∞—á–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ MelonService: {} (–≤–æ–∑–º–æ–∂–Ω–æ, –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞ –∏–ª–∏ —É–∂–µ —É–¥–∞–ª–µ–Ω–∞)", taskId);
        return Map.of(
            "status", "not_found",
            "message", "–ó–∞–¥–∞—á–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ MelonService"
        );
        
    } catch (Exception e) {
        logger.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏ {}: {}", taskId, e.getMessage());
        return Map.of(
            "status", "error",
            "message", "–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞: " + e.getMessage()
        );
    }
}
```

**–£–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ **404 –æ—à–∏–±–æ–∫**
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ **–ø—É—Å—Ç—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤**
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ **–æ–±—â–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π**
- ‚úÖ **Graceful degradation** - –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Map

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: JSON —Ñ–∞–π–ª –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω

```
–ü–æ–ø—ã—Ç–∫–∞ 1: GET /manga-info/another ‚Üí 404 (—Ñ–∞–π–ª –Ω–µ –≥–æ—Ç–æ–≤)
  ‚Üì
–ó–∞–¥–µ—Ä–∂–∫–∞ 3 —Å–µ–∫—É–Ω–¥—ã
  ‚Üì
–ü–æ–ø—ã—Ç–∫–∞ 2: GET /manga-info/another ‚Üí 404 (—Ñ–∞–π–ª –≤—Å–µ –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤)
  ‚Üì
–ó–∞–¥–µ—Ä–∂–∫–∞ 3 —Å–µ–∫—É–Ω–¥—ã
  ‚Üì
–ü–æ–ø—ã—Ç–∫–∞ 3: GET /manga-info/another ‚Üí 200 (—Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω!)
  ‚Üì
‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω manga-info
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: JSON —Ñ–∞–π–ª —Ç–∞–∫ –∏ –Ω–µ –±—ã–ª —Å–æ–∑–¥–∞–Ω

```
–ü–æ–ø—ã—Ç–∫–∞ 1-5: GET /manga-info/another ‚Üí 404
  ‚Üì
–í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã
  ‚Üì
–í–æ–∑–≤—Ä–∞—Ç: {error: "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å manga-info –ø–æ—Å–ª–µ 5 –ø–æ–ø—ã—Ç–æ–∫", filename: "another"}
  ‚Üì
‚ùå –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π, –Ω–æ –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥ –ü–†–û–î–û–õ–ñ–ê–ï–¢–°–Ø –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –º–∞–Ω–≥
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ó–∞–¥–∞—á–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

```
waitForTaskCompletion(taskId):
  ‚Üì
–ü–æ–ø—ã—Ç–∫–∞ 1: GET /status/xxx-yyy ‚Üí 404
  ‚Üì
getTaskStatus() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: {status: "not_found", message: "..."}
  ‚Üì
–ü–æ–ø—ã—Ç–∫–∞ 2: GET /status/xxx-yyy ‚Üí 200 {status: "running"}
  ‚Üì
‚úÖ –û–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

## –í–ª–∏—è–Ω–∏–µ –Ω–∞ –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥

### –î–û —Ñ–∏–∫—Å–∞:
```
–ú–∞–Ω–≥–∞ 1: ‚úÖ –£—Å–ø–µ—à–Ω–æ
–ú–∞–Ω–≥–∞ 2: ‚úÖ –£—Å–ø–µ—à–Ω–æ
–ú–∞–Ω–≥–∞ 3: ‚úÖ –£—Å–ø–µ—à–Ω–æ
–ú–∞–Ω–≥–∞ 4: ‚ùå JSON –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí EXCEPTION ‚Üí –í–°–Ø –ó–ê–î–ê–ß–ê –ü–†–ï–†–´–í–ê–ï–¢–°–Ø
–ú–∞–Ω–≥–∞ 5: ‚è≠Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–∞
–ú–∞–Ω–≥–∞ 6: ‚è≠Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–∞
...
```

### –ü–û–°–õ–ï —Ñ–∏–∫—Å–∞:
```
–ú–∞–Ω–≥–∞ 1: ‚úÖ –£—Å–ø–µ—à–Ω–æ
–ú–∞–Ω–≥–∞ 2: ‚úÖ –£—Å–ø–µ—à–Ω–æ
–ú–∞–Ω–≥–∞ 3: ‚úÖ –£—Å–ø–µ—à–Ω–æ
–ú–∞–Ω–≥–∞ 4: üîÑ JSON –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí RETRY (5 –ø–æ–ø—ã—Ç–æ–∫) ‚Üí ‚úÖ –£—Å–ø–µ—à–Ω–æ –ò–õ–ò ‚ùå –û—à–∏–±–∫–∞ (graceful)
–ú–∞–Ω–≥–∞ 5: ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ú–∞–Ω–≥–∞ 4
–ú–∞–Ω–≥–∞ 6: ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è
...
```

## –õ–æ–≥–∏

### –£—Å–ø–µ—à–Ω—ã–π retry:
```
INFO: –ü–æ–ª—É—á–µ–Ω–∏–µ manga-info –¥–ª—è 'another' (–ø–æ–ø—ã—Ç–∫–∞ 1/5)
WARN: JSON —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è 'another' (–ø–æ–ø—ã—Ç–∫–∞ 1/5): 404 NOT_FOUND. 
      –í–æ–∑–º–æ–∂–Ω–æ, MelonService –µ—â–µ –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 3000ms...
INFO: –ü–æ–ª—É—á–µ–Ω–∏–µ manga-info –¥–ª—è 'another' (–ø–æ–ø—ã—Ç–∫–∞ 2/5)
INFO: –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω manga-info –¥–ª—è 'another'
```

### –ò—Å—á–µ—Ä–ø–∞–Ω—ã –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏:
```
INFO: –ü–æ–ª—É—á–µ–Ω–∏–µ manga-info –¥–ª—è 'broken-manga' (–ø–æ–ø—ã—Ç–∫–∞ 1/5)
WARN: JSON —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è 'broken-manga' (–ø–æ–ø—ã—Ç–∫–∞ 1/5): 404 NOT_FOUND...
...
INFO: –ü–æ–ª—É—á–µ–Ω–∏–µ manga-info –¥–ª—è 'broken-manga' (–ø–æ–ø—ã—Ç–∫–∞ 5/5)
WARN: JSON —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è 'broken-manga' (–ø–æ–ø—ã—Ç–∫–∞ 5/5): 404 NOT_FOUND...
ERROR: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å manga-info –¥–ª—è 'broken-manga' –ø–æ—Å–ª–µ 5 –ø–æ–ø—ã—Ç–æ–∫
ERROR: –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –∏–ª–∏ –æ—á–∏—Å—Ç–∫–µ –¥–ª—è slug=broken-manga: ...
```

## –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **MangaService/src/main/java/shadowshift/studio/mangaservice/service/MelonIntegrationService.java**
   - –ú–µ—Ç–æ–¥ `getMangaInfo()`: –î–æ–±–∞–≤–ª–µ–Ω–∞ retry –ª–æ–≥–∏–∫–∞ (5 –ø–æ–ø—ã—Ç–æ–∫ √ó 3 —Å–µ–∫)
   - –ú–µ—Ç–æ–¥ `getTaskStatus()`: –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏

```bash
# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ MangaService
cd C:\project\AniWayImageSystem\AniWay-Reload\MangaService
.\gradlew.bat build -x test

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
cd C:\project\AniWayImageSystem\AniWay-Reload
docker-compose build manga-service

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose up -d manga-service
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ê–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥ —Å limit=10

```bash
curl -X POST "http://localhost:8083/api/manga/auto-parse?page=1&limit=10"
```

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –í—Å–µ 10 –º–∞–Ω–≥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- –ü—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö 404 ‚Üí retry –¥–æ 5 —Ä–∞–∑
- –î–∞–∂–µ –µ—Å–ª–∏ 1 –º–∞–Ω–≥–∞ —É–ø–∞–ª–∞ —Å –æ—à–∏–±–∫–æ–π ‚Üí –æ—Å—Ç–∞–ª—å–Ω—ã–µ 9 –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
docker-compose logs -f manga-service | grep -E "(–ü–æ–ª—É—á–µ–Ω–∏–µ manga-info|–ø–æ–ø—ã—Ç–∫–∞|–£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω|–∏—Å—á–µ—Ä–ø–∞–Ω—ã)"
```

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:**
- –ü–æ–ø—ã—Ç–∫–∏ –ø–æ–ª—É—á–µ–Ω–∏—è manga-info
- Retry –ø—Ä–∏ 404
- –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –ò–õ–ò —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ø–æ–ø—ã—Ç–æ–∫

### –¢–µ—Å—Ç 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥–∞

```bash
# –ü–æ–ª—É—á–∏—Ç—å taskId –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
curl "http://localhost:8083/api/manga/auto-parse-status/{taskId}"
```

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- `processed_slugs` —Ä–∞—Å—Ç–µ—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ
- `failed_slugs` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω–æ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –º–∞–Ω–≥–∏
- `logs` —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ retry

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –í–æ–∑–º–æ–∂–Ω—ã–µ –±—É–¥—É—â–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

1. **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ retry:**
   ```java
   int retryDelayMs = 1000 * (1 << (attempt - 1)); // 1s, 2s, 4s, 8s, 16s
   ```

2. **Circuit Breaker Pattern:**
   - –ï—Å–ª–∏ MelonService –ø–∞–¥–∞–µ—Ç –¥–ª—è 3+ –º–∞–Ω–≥ –ø–æ–¥—Ä—è–¥ ‚Üí –≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥
   
3. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥:**
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å 2-3 –º–∞–Ω–≥–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ MelonService)

4. **Health check MelonService:**
   - –ü–µ—Ä–µ–¥ –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥–æ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å MelonService

## –ò—Ç–æ–≥

**‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û:** –ê–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥ —Ç–µ–ø–µ—Ä—å —É—Å—Ç–æ–π—á–∏–≤ –∫ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–∞–º —Å JSON —Ñ–∞–π–ª–∞–º–∏

**–ú–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã:**
1. Retry –ª–æ–≥–∏–∫–∞ –≤ `getMangaInfo()` (5 √ó 3 —Å–µ–∫)
2. Graceful degradation - –æ—à–∏–±–∫–∏ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –≤–µ—Å—å –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥
3. –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ `getTaskStatus()`

**–í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:**
- –ú–∞–∫—Å–∏–º—É–º 15 —Å–µ–∫—É–Ω–¥ –Ω–∞ 1 –º–∞–Ω–≥—É (5 –ø–æ–ø—ã—Ç–æ–∫ √ó 3 —Å–µ–∫)
- –ê–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫
