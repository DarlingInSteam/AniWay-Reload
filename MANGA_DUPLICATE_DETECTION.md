# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –º–∞–Ω–≥–∏ –≤ —Å–∏—Å—Ç–µ–º–µ

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –º–∞–Ω–≥–∏ —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ `melonSlug`.

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ `melonSlug`

–í —Å—É—â–Ω–æ—Å—Ç–∏ `Manga` –ø–æ–ª–µ `melonSlug` –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```java
@Column(name = "melon_slug", length = 255, unique = true)
private String melonSlug;
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ **–¥–≤–µ –º–∞–Ω–≥–∏ –Ω–µ –º–æ–≥—É—Ç –∏–º–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π `melonSlug`**.

## –ú–µ—Ç–æ–¥—ã —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

### 1. üìù –°–æ–∑–¥–∞–Ω–∏–µ –º–∞–Ω–≥–∏ - `createManga()`

**–ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è**: –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –º–∞–Ω–≥–∏ —á–µ—Ä–µ–∑ API

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç**:
- –ï—Å–ª–∏ –≤ –∑–∞–ø—Ä–æ—Å–µ —É–∫–∞–∑–∞–Ω `melonSlug`, —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
- –ï—Å–ª–∏ –º–∞–Ω–≥–∞ —Å —Ç–∞–∫–∏–º `melonSlug` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ

**–ü—Ä–∏–º–µ—Ä**:
```java
if (StringUtils.hasText(createDTO.getMelonSlug())) {
    String normalizedSlug = createDTO.getMelonSlug().trim();
    if (mangaRepository.existsByMelonSlug(normalizedSlug)) {
        throw new MangaValidationException(
            "–ú–∞–Ω–≥–∞ —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º Melon slug —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: " + normalizedSlug
        );
    }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ú–∞–Ω–≥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è, –µ—Å–ª–∏ `melonSlug` —É–Ω–∏–∫–∞–ª–µ–Ω –∏–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω
- ‚ùå –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `MangaValidationException`, –µ—Å–ª–∏ `melonSlug` —É–∂–µ –∑–∞–Ω—è—Ç

---

### 2. üì• –ò–º–ø–æ—Ä—Ç –∏–∑ Melon - `createMangaFromMelon()`

**–ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è**: –ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –º–∞–Ω–≥–∏ –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ MelonService

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç**:
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ `melonSlug` –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∏–º–ø–æ—Ä—Ç –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –º–∞–Ω–≥–∏

**–õ–æ–≥–∏–∫–∞**: –ò–¥–µ–Ω—Ç–∏—á–Ω–∞ –º–µ—Ç–æ–¥—É `createManga()`

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ú–∞–Ω–≥–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è, –µ—Å–ª–∏ —ç—Ç–æ –Ω–æ–≤–∞—è –º–∞–Ω–≥–∞
- ‚ùå –ò–º–ø–æ—Ä—Ç –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è, –µ—Å–ª–∏ –º–∞–Ω–≥–∞ —É–∂–µ –±—ã–ª–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–∞–Ω–µ–µ

---

### 3. ‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–Ω–≥–∏ - `updateManga()`

**–ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è**: –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –º–∞–Ω–≥–∏

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç**:
- –ï—Å–ª–∏ `melonSlug` **–∏–∑–º–µ–Ω–∏–ª—Å—è**, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
- –ï—Å–ª–∏ `melonSlug` **–Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è**, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

**–ü—Ä–∏–º–µ—Ä**:
```java
if (StringUtils.hasText(updateDTO.getMelonSlug())) {
    String normalizedSlug = updateDTO.getMelonSlug().trim();
    String currentSlug = existingManga.getMelonSlug();
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ slug –∏–∑–º–µ–Ω–∏–ª—Å—è
    if (!normalizedSlug.equals(currentSlug)
            && mangaRepository.existsByMelonSlug(normalizedSlug)) {
        throw new MangaValidationException(
            "–ú–∞–Ω–≥–∞ —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º Melon slug —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: " + normalizedSlug
        );
    }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –Ω–æ–≤—ã–π `melonSlug` —É–Ω–∏–∫–∞–ª–µ–Ω
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ `melonSlug` –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
- ‚ùå –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–æ–≤—ã–π `melonSlug` —É–∂–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–æ–π –º–∞–Ω–≥–æ–π

---

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

1. **–°–æ–∑–¥–∞–Ω–∏–µ –º–∞–Ω–≥–∏ –±–µ–∑ melonSlug**
   ```json
   {
     "title": "–ù–æ–≤–∞—è –º–∞–Ω–≥–∞",
     "description": "–û–ø–∏—Å–∞–Ω–∏–µ"
   }
   ```
   ‚Üí –ú–∞–Ω–≥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –±–µ–∑ –ø—Ä–æ–±–ª–µ–º

2. **–°–æ–∑–¥–∞–Ω–∏–µ –º–∞–Ω–≥–∏ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º melonSlug**
   ```json
   {
     "title": "–ù–æ–≤–∞—è –º–∞–Ω–≥–∞",
     "melonSlug": "unique-manga-123"
   }
   ```
   ‚Üí –ú–∞–Ω–≥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è, –µ—Å–ª–∏ `unique-manga-123` –µ—â–µ –Ω–µ –∑–∞–Ω—è—Ç

3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–Ω–≥–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è melonSlug**
   ```json
   {
     "title": "–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ",
     "melonSlug": "existing-slug"  // –¢–æ—Ç –∂–µ slug, —á—Ç–æ –±—ã–ª
   }
   ```
   ‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ

### ‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

1. **–ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç –ø–æ melonSlug**
   ```json
   {
     "title": "–î—É–±–ª–∏–∫–∞—Ç –º–∞–Ω–≥–∏",
     "melonSlug": "existing-manga-slug"  // –£–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!
   }
   ```
   ‚Üí –û—à–∏–±–∫–∞: `MangaValidationException: –ú–∞–Ω–≥–∞ —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º Melon slug —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: existing-manga-slug`

2. **–ü–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å melonSlug –Ω–∞ —É–∂–µ –∑–∞–Ω—è—Ç—ã–π**
   ```json
   {
     "id": 1,
     "melonSlug": "another-manga-slug"  // –≠—Ç–æ—Ç slug –∑–∞–Ω—è—Ç –º–∞–Ω–≥–æ–π —Å ID=2
   }
   ```
   ‚Üí –û—à–∏–±–∫–∞: `MangaValidationException: –ú–∞–Ω–≥–∞ —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º Melon slug —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: another-manga-slug`

---

## –î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–¥–≤–∞ —É—Ä–æ–≤–Ω—è –∑–∞—â–∏—Ç—ã** –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:

1. **–ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** (Application Level)
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –º–µ—Ç–æ–¥–∞—Ö —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ø—ã—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ë–î** (Database Level)
   - `unique = true` –Ω–∞ —Å—Ç–æ–ª–±—Ü–µ `melon_slug`
   - –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–∂–µ –ø—Ä–∏ –æ–±—Ö–æ–¥–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
   - –ü–æ—Å–ª–µ–¥–Ω—è—è –ª–∏–Ω–∏—è –∑–∞—â–∏—Ç—ã

---

## –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π - –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏

–í `MangaRepository` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –º–µ—Ç–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è:

```java
boolean existsByMelonSlug(String melonSlug);
```

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è Spring Data JPA –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å:
```sql
SELECT COUNT(*) > 0 FROM manga WHERE melon_slug = ?
```

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**: –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ `melonSlug`
2. **–ü—Ä–∏ —Ä—É—á–Ω–æ–º —Å–æ–∑–¥–∞–Ω–∏–∏ –º–∞–Ω–≥–∏**: `melonSlug` –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω
3. **–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏**: –ù–µ –º–µ–Ω—è–π—Ç–µ `melonSlug` –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –õ–æ–≤–∏—Ç–µ `MangaValidationException` –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–æ–∫—Ç—è–±—Ä—å 2025)

### –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –º–µ—Ç–æ–¥ `createManga` –ø–æ—Ç–µ—Ä—è–ª –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã.

### –†–µ—à–µ–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –º–∞–Ω–≥–∏ –ø–æ `melonSlug` –≤ –º–µ—Ç–æ–¥ `createManga`:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—Ç –∂–µ –ø–æ–¥—Ö–æ–¥, —á—Ç–æ –∏ –≤ `createMangaFromMelon`
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–Ω–æ–≤–∞ –∑–∞—â–∏—â–µ–Ω–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- `MangaService.java` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ `createManga()`
- `MANGA_SERVICE_BUILD_FIX.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
