# AniWay API Gateway

API Gateway –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —á—Ç–µ–Ω–∏—è –º–∞–Ω–≥–∏ AniWay. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω—É—é —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º.

## üöÄ –§—É–Ω–∫—Ü–∏–∏ Gateway

- **–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞** - –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç 8080
- **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫ –Ω—É–∂–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º
- **CORS –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - endpoints –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –æ–± –æ—à–∏–±–∫–∞—Ö

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏

```
Frontend/Client ‚Üí API Gateway (8080) ‚Üí Backend Services
                        ‚îÇ
                        ‚îú‚îÄ /api/manga/**     ‚Üí MangaService (8081)
                        ‚îú‚îÄ /manga/**         ‚Üí MangaService Web UI (8081)
                        ‚îú‚îÄ /reader/**        ‚Üí MangaService Reader (8081)
                        ‚îú‚îÄ /chapters/**      ‚Üí MangaService Chapters (8081)
                        ‚îú‚îÄ /api/chapters/**  ‚Üí ChapterService (8082)
                        ‚îú‚îÄ /api/images/**    ‚Üí ImageStorageService (8083)
                        ‚îî‚îÄ /static/**        ‚Üí Static Resources (8081)
```

## üì° Gateway Endpoints

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Gateway

**GET /api/gateway/health**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è Gateway
- –û—Ç–≤–µ—Ç: `{"status": "UP", "message": "API Gateway —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"}`

**GET /api/gateway/info**
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Gateway –∏ –≤–µ—Ä—Å–∏–∏
- –û—Ç–≤–µ—Ç: –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**GET /api/gateway/routes** 
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
- –û—Ç–≤–µ—Ç: –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –º–∞—Ä—à—Ä—É—Ç–∞—Ö

**GET /api/gateway/services/health**
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö backend —Å–µ—Ä–≤–∏—Å–æ–≤
- –û—Ç–≤–µ—Ç: –°—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ (UP/DOWN/DEGRADED)

### Spring Boot Actuator

**GET /actuator/health**
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è Spring Boot

**GET /actuator/gateway/routes**
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Ä—à—Ä—É—Ç–∞—Ö Gateway

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. Java 21+
2. –ó–∞–ø—É—â–µ–Ω–Ω—ã–µ backend —Å–µ—Ä–≤–∏—Å—ã:
   - MangaService –Ω–∞ –ø–æ—Ä—Ç—É 8081
   - ChapterService –Ω–∞ –ø–æ—Ä—Ç—É 8082  
   - ImageStorageService –Ω–∞ –ø–æ—Ä—Ç—É 8083

### –ó–∞–ø—É—Å–∫ Gateway

```bash
# –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫
./gradlew bootRun

# –ò–ª–∏ —Å–æ–±—Ä–∞—Ç—å JAR –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å
./gradlew build
java -jar build/libs/GateWayService-0.0.1-SNAPSHOT.jar
```

Gateway –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:8080`

## üåê CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

Gateway –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å:
- `http://localhost:3000` (React dev server)
- `http://localhost:5173` (Vite dev server)
- `http://localhost:8080` (—Å–∞–º Gateway)
- `http://localhost:8081` (MangaService —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç–æ–¥—ã: GET, POST, PUT, DELETE, OPTIONS, HEAD

## üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

–¢–µ–ø–µ—Ä—å –≤—Å–µ API –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –Ω–∞ Gateway:

```javascript
// –í–º–µ—Å—Ç–æ: http://localhost:8081/api/manga
// –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: http://localhost:8080/api/manga

const response = await fetch('http://localhost:8080/api/manga');
const mangaList = await response.json();
```

### –î–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å MangaService —Ç–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ Gateway:
- –ö–∞—Ç–∞–ª–æ–≥: `http://localhost:8080/manga`
- –°–æ–∑–¥–∞–Ω–∏–µ –º–∞–Ω–≥–∏: `http://localhost:8080/manga/create`
- –†–∏–¥–µ—Ä: `http://localhost:8080/reader/{chapterId}`

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `application.yml`:

- –ü–æ—Ä—Ç Gateway: `server.port: 8080`
- –¢–∞–π–º-–∞—É—Ç—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: 10 —Å–µ–∫—É–Ω–¥
- –¢–∞–π–º-–∞—É—Ç—ã –æ—Ç–≤–µ—Ç–∞: 30 —Å–µ–∫—É–Ω–¥
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: DEBUG —É—Ä–æ–≤–µ–Ω—å –¥–ª—è Gateway –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
curl http://localhost:8080/api/gateway/services/health
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤

```bash
curl http://localhost:8080/api/gateway/routes
```

### –õ–æ–≥–∏ Gateway

Gateway –≤—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:
```
üåê Incoming Request: GET /api/manga from 127.0.0.1
‚úÖ Response: GET /api/manga ‚Üí 200 | Duration: 45ms
```

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **503 Service Unavailable** - Backend —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—Ç—É
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞

2. **CORS –æ—à–∏–±–∫–∏** - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ CORS
   - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ origin –¥–æ–±–∞–≤–ª–µ–Ω –≤ allowed-origins
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ preflight –∑–∞–ø—Ä–æ—Å—ã (OPTIONS)

3. **404 Not Found** - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∏—Å–æ–∫ –º–∞—Ä—à—Ä—É—Ç–æ–≤: `/api/gateway/routes`
   - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—É—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–µ–¥–∏–∫–∞—Ç–∞–º

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

Gateway –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

1. **Custom endpoints** - `/api/gateway/*`
2. **Spring Actuator** - `/actuator/*` 
3. **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** (–≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞)

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è development –æ–∫—Ä—É–∂–µ–Ω–∏—è. –î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å CORS origins –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏
2. –î–æ–±–∞–≤–∏—Ç—å rate limiting
3. –î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS
5. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

---

**–ê–≤—Ç–æ—Ä:** AniWay Development Team  
**–í–µ—Ä—Å–∏—è:** 1.0.0
